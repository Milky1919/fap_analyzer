# 開発環境構築手順書 (Windows 11 + VSCode + Docker)

## 1. はじめに

このドキュメントは、投稿評価アルゴリズム「Orionis-Prime-Final」の開発を行うための、Dockerコンテナベースの開発環境をWindows 11上に構築する手順を定義するものです。

**目標:**

*   Windows PC上で、本番環境（Raspberry Pi/Linux）と隔離された、クリーンで再現性の高い開発環境を構築する。
*   Visual Studio Code (VSCode) の強力な開発支援機能を活用し、効率的に開発を進める準備を整える。
*   この手順を完了することで、即座にプロジェクトのコーディング（スクレイピング処理の実装）を開始できる状態になる。

## 2. フェーズ1: 必須ツールのインストール

まず、開発の土台となる2つの重要なツールをWindowsにインストールします。

### ステップ1: Visual Studio Code (VSCode) のインストール

*   **役割:** プログラムを書くための高機能なテキストエディタです。

1.  [**VSCode公式サイト**](https://code.visualstudio.com/ "null") にアクセスし、Windows版のインストーラーをダウンロードして実行します。
2.  インストール中に表示される「その他」の項目では、**「'Code'で開く' アクションをエクスプローラーのファイル コンテキスト メニューに追加する」** と **「'Code'で開く' アクションをエクスプローラーのディレクトリ コンテキスト メニューに追加する」** の両方にチェックを入れることを推奨します。

### ステップ2: Docker Desktop for Windows のインストール

*   **役割:** PC内にOSレベルで隔離された仮想開発環境（コンテナ）を作成・管理するためのツールです。

1.  [**Docker公式サイト**](https://www.docker.com/products/docker-desktop/ "null") にアクセスし、Docker Desktop for Windows をダウンロードして実行します。
2.  インストール中に **「Use WSL 2 instead of Hyper-V (recommended)」** というオプションが表示されたら、必ずチェックを入れてください。
    
    *   **補足:** WSL 2 (Windows Subsystem for Linux 2) は、Windows上でLinuxを効率的に実行するための仕組みです。Docker Desktopはこれを利用します。もしWSL 2が未導入の場合は、インストールを促すメッセージが表示されることがありますので、指示に従ってください。
3.  インストール完了後、PCの再起動を求められる場合があります。
4.  再起動後、Docker Desktopが起動し、タスクバーの通知領域にクジラのアイコンが表示されていれば成功です。初回起動には数分かかることがあります。

## 3. フェーズ2: プロジェクトとDocker環境のセットアップ

次に、プロジェクトのフォルダを作成し、その内部にDocker環境の「設計図」を配置します。

### ステップ1: プロジェクトフォルダの作成

1.  エクスプローラーで、開発プロジェクトを保存したい場所（例: `C:\` や `ドキュメント` フォルダ直下）に、`fap_analyzer` という名前の新しいフォルダを作成します。

### ステップ2: VSCodeでプロジェクトを開き、拡張機能を導入

1.  VSCodeを起動します。
2.  左上のメニューから `ファイル` > `フォルダーを開く...` を選択し、先ほど作成した `fap_analyzer` フォルダを開きます。
3.  左側のサイドバーにある拡張機能アイコン（四角が4つ並んだアイコン）をクリックします。
4.  検索バーに `Dev Containers` と入力し、Microsoftが提供している拡張機能をインストールします。この拡張機能が、VSCodeとDockerを連携させるための鍵となります。

### ステップ3: Docker環境の設計図を作成

プロジェクトフォルダ（`fap_analyzer`）の直下に、これから開発するプログラムを動かすための環境の「設計図」となる3つのファイルを作成します。

#### 1. `Dockerfile` の作成

*   **役割:** コンテナのOSや、インストールするツール（Python, MeCabなど）を定義する最も重要な設計図です。
*   `fap_analyzer` フォルダ内に `Dockerfile` という名前のファイルを新規作成し、以下の内容をそのままコピー＆ペーストしてください。
    
    ```
    # ベースとなるOSとPythonのバージョンを指定
    FROM python:3.10-slim
    
    # 環境変数の設定（Pythonのログ出力を調整）
    ENV PYTHONUNBUFFERED 1
    
    # システムパッケージの更新と、MeCabおよびビルドに必要なツールのインストール
    RUN apt-get update && apt-get install -y \
        mecab \
        libmecab-dev \
        mecab-ipadic-utf8 \
        git \
        make \
        curl \
        g++ \
        --no-install-recommends \
        && rm -rf /var/lib/apt/lists/*
    
    # プロジェクトファイルを格納するディレクトリを作成
    WORKDIR /app
    
    # 必要なPythonライブラリをインストールするためのリストをコピー
    COPY requirements.txt .
    
    # pipを使ってPythonライブラリをインストール
    RUN pip install --no-cache-dir -r requirements.txt
    
    # コンテナの起動時に実行されるデフォルトのコマンド（何もしないで待機）
    CMD ["tail", "-f", "/dev/null"]
    
    ```
    

#### 2. `requirements.txt` の作成

*   **役割:** プロジェクトで必要となるPythonライブラリの一覧です。
*   `fap_analyzer` フォルダ内に `requirements.txt` という名前のファイルを新規作成し、以下の内容をコピー＆ペーストしてください。
    
    ```
    requests
    beautifulsoup4
    scikit-learn
    numpy
    mecab-python3
    
    ```
    

#### 3. `.devcontainer/devcontainer.json` の作成

*   **役割:** VSCodeの `Dev Containers` 拡張機能に対して、どの`Dockerfile`を使ってコンテナを起動するかを指示する設定ファイルです。
*   まず、`fap_analyzer` フォルダ内に `.devcontainer` という名前の新しいフォルダを作成します。
*   次に、その `.devcontainer` フォルダの中に `devcontainer.json` という名前のファイルを新規作成し、以下の内容をコピー＆ペーストしてください。
    
    ```
    {
        "name": "FAP Analyzer Dev Container",
        "build": {
            "dockerfile": "../Dockerfile"
        },
        "customizations": {
            "vscode": {
                "extensions": [
                    "ms-python.python"
                ]
            }
        },
        "forwardPorts": [],
        "postCreateCommand": "echo 'Container is ready!'",
        "remoteUser": "root"
    }
    
    ```
    

この時点で、プロジェクトフォルダの構成は以下のようになっているはずです。

```
fap_analyzer/
├── .devcontainer/
│   └── devcontainer.json
├── Dockerfile
└── requirements.txt

```

## 4. フェーズ3: 開発コンテナの起動と検証

設計図が完成したので、いよいよ開発環境を起動します。

1.  VSCodeの左下にある緑色の `><` アイコンをクリックします。
2.  画面上部にコマンドパレットが表示されるので、**「Reopen in Container」** を選択します。
3.  VSCodeがDockerイメージのビルドを開始します。初回は必要なツールやライブラリのダウンロードとインストールが行われるため、**5〜15分程度の時間**がかかります。進捗はログで確認できます。
4.  ビルドが完了すると、VSCodeのウィンドウがリロードされます。左下の緑色の表示が **「Dev Container: FAP Analyzer Dev Container」** に変わっていれば、コンテナへの接続は成功です。

おめでとうございます！これであなたのVSCodeは、Windows上で動きながら、内部ではプロジェクト専用のLinux環境に接続された状態になりました。

### 最終検証

1.  VSCodeのメニューから `ターミナル` > `新しいターミナル` を選択します。
2.  表示されたターミナルは、Windowsのものではなく、**Dockerコンテナ内のLinuxターミナル**です。
3.  以下のコマンドを1つずつ入力し、エラーが出ずにバージョン情報などが表示されることを確認してください。
    
    ```
    # Pythonのバージョン確認
    python --version
    
    # MeCabの動作確認（「すもももももももものうち」と表示されればOK）
    echo "すもももももももものうち" | mecab
    
    # PythonからMeCabを呼び出せるか確認
    python -c "import MeCab; print('MeCab import OK')"
    
    ```